<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Calnect</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <link href="style.css" rel="stylesheet">
  <script src="scripts.js"></script>
</head>

<body>
  <!-- added a holder for the navbar so we don't have to copy all of the code for every page -->
  <div id="nav-holder"></div>
  <h2 class="text-center"><b>What are you accomplishing today?</b></h2>

  <!-- added a holder for timeslots so we don't have to copy all of the code for every page -->
  <section class="container">
    <div class="row" id="toptime">
      <div class="col-2">12 am</div>
    </div>
    <div class="row">
      <div class="col-2">1 am</div>
    </div>
    <div class="row">
      <div class="col-2">2 am</div>
    </div>
    <div class="row">
      <div class="col-2">3 am</div>
    </div>
    <div class="row">
      <div class="col-2">4 am</div>
    </div>
    <div class="row">
      <div class="col-2">5 am</div>
    </div>
    <div class="row">
      <div class="col-2">6 am</div>
    </div>
    <div class="row">
      <div class="col-2">7 am</div>
    </div>
    <div class="row">
      <div class="col-2">8 am</div>
    </div>
    <div class="row">
      <div class="col-2">9 am</div>
    </div>
    <div class="row">
      <div class="col-2">10 am</div>
    </div>
    <div class="row">
      <div class="col-2">11 am</div>
    </div>
    <div class="row">
      <div class="col-2">12 pm</div>
    </div>
    <div class="row">
      <div class="col-2">1 pm</div>
    </div>
    <div class="row">
      <div class="col-2">2 pm</div>
    </div>
    <div class="row">
      <div class="col-2">3 pm</div>
    </div>
    <div class="row">
      <div class="col-2">4 pm</div>
    </div>
    <div class="row">
      <div class="col-2">5 pm</div>
    </div>
    <div class="row">
      <div class="col-2">6 pm</div>
    </div>
    <div class="row">
      <div class="col-2">7 pm</div>
    </div>
    <div class="row">
      <div class="col-2">8 pm</div>
    </div>
    <div class="row">
      <div class="col-2">9 pm</div>
    </div>
    <div class="row">
      <div class="col-2">10 pm</div>
    </div>
    <div class="row">
      <div class="col-2">11 pm</div>
    </div>
  </section>
  <div id="bottom"></div>

  <!--Add navbar-->
  <script src="//code.jquery.com/jquery.min.js"></script>
  <script>
    $.get("navbar.html", function (data) {
      $("#nav-holder").replaceWith(data);
    });

    document.getElementsByClassName("col-2").addEventListener("click", editInfo());
    function editInfo() {
      alert("clicked")
    }
  </script>


  <!-- Modal code from w3Schools -->
  <h2>MyCal</h2>

  <!-- Trigger/Open The Modal -->
  <button id="myBtn">Create Event</button>

  <!-- The Modal -->
  <div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <form name="create-event">
        <label for="event-name">Event name:</label>
        <input type="text" id="event-name" name="event-name" required placeholder="Enter Name"
          oninvalid="this.setCustomValidity('Please enter a name for the event')" oninput="this.setCustomValidity('')">
        <label for="start-time">Start time:</label>
        <input type="time" id="start-time" name="start-time" value="12:00">
        <label for="end-time">End time:</label>
        <input type="time" id="end-time" name="end-time" value="13:00">
        <input type="submit" id="submit-button" name="submit-button" value="Create Event">
      </form>
    </div>

  </div>

  <script>
    // console.log(v)

    // Known bug: When the form validation doesn't pass (eg start time 
    // is after end time), you need to refresh the page to try again.

    const endTime = document.getElementById("end-time");
    const form = document.querySelector('form');
    // const jsonOut;
    form.addEventListener('submit', event => {
      console.log("here");
      event.preventDefault();

      const data = new FormData(event.target);

      const value = Object.fromEntries(data.entries());

      // let start = document.forms["createEvent"]["start-time"].value;
      // let end = document.forms["createEvent"]["end-time"].value;

      // console.log({start, end});

      console.log({ value });

      console.log("Valid Time: " + validTime(value["start-time"], value["end-time"]));

      if (!validTime(value["start-time"], value["end-time"])) {
        endTime.setCustomValidity("End time must be after start time");
        endTime.reportValidity();
      } else {
        endTime.setCustomValidity("");
        modal.style.display = "none";
      }

      const jsonOut = JSON.stringify(value)
      localStorage.setItem(jsonOut, "eventData");
    });


    // Get the modal
    var modal = document.getElementById("myModal");

    // Get the button that opens the modal
    var btn = document.getElementById("myBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks the button, open the modal 
    btn.onclick = function () {
      modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
      modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }

    // endTime.addEventListener("end-time", (event) => {
    // });

  </script>

</body>